clusterName: demo
opentelemetry-operator:
  enabled: true
defaultCRConfig:
  image:
    repository: jaronoff/contrib
    tag: "v05"
collectors:
  daemon:
    env:
      - name: LS_TOKEN
        valueFrom:
          secretKeyRef:
            key: LS_TOKEN
            name: otel-collector-secret
    config:
      extensions:
        healthcheckv2:
          use_v2: true
          component_health:
            include_permanent_errors: false
            include_recoverable_errors: true
            recovery_duration: 5m
          http:
            endpoint: "0.0.0.0:13133"
            status:
              enabled: true
              path: "/health/status"
            config:
              enabled: true
              path: "/health/config"
          grpc:
            endpoint: "0.0.0.0:13132"
            transport: "tcp"
      exporters:
        otlp:
          endpoint: ingest.lightstep.com:443
          headers:
            lightstep-access-token: ${LS_TOKEN}
      service:
        extensions: [healthcheckv2]
        pipelines:
          metrics:
            exporters: [otlp]
          traces:
            exporters: [otlp]
          logs:
            exporters: [otlp]
  cluster:
    env:
      - name: LS_TOKEN
        valueFrom:
          secretKeyRef:
            key: LS_TOKEN
            name: otel-collector-secret
    config:
      exporters:
        otlp:
          endpoint: ingest.lightstep.com:443
          headers:
            lightstep-access-token: ${LS_TOKEN}
      service:
        pipelines:
          metrics:
            exporters: [otlp]
instrumentation:
  enabled: true
  env:
    - name: OTEL_K8S_NODE_NAME
      valueFrom:
        fieldRef:
          fieldPath: spec.nodeName
  exporter:
    endpoint: http://${OTEL_K8S_NODE_NAME}:4317
  python:
    env:
      - name: OTEL_EXPORTER_OTLP_ENDPOINT
        value: http://${OTEL_K8S_NODE_NAME}:4318
opAMPBridge:
  enabled: true
  addReportingLabel: true
  image:
    tag: "0.104.0"
  endpoint: https://opamp.lightstep.com/v1/opamp
  headers:
    "Authorization": "bearer ${LS_OPAMP_API_KEY}"
  env:
    - name: LS_OPAMP_API_KEY
      valueFrom:
        secretKeyRef:
          key: LS_OPAMP_API_KEY
          name: otel-opamp-bridge-secret
          optional: true
